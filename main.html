<!DOCTYPE html>
<html lang="ko">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>

    <link rel="stylesheet" href="assets/css/common.css" />
    <link rel="stylesheet" href="assets/css/main.css" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.5.1/gsap.min.js"></script>
    <script src="https://unpkg.com/gsap@3/dist/ScrollTrigger.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/locomotive-scroll@3.5.4/dist/locomotive-scroll.min.js"></script>
  </head>
  <body>
    <main id="contents">

        <section id="section1" class="visual" data-textcolor="#bcb8ad" data-bgcolor="#fff">
            <div class="visual__tit">
                <h2>G.SUNAH<br/>PORTFOLIO</h2>
                <span class="visual__tit--move">HELLO, WORLD!</span>
            </div>

            <div class="visual__sbj demo">
                <div class="visual__sbj-move wrapper" data-text="I'M FRONTEND DEVELOPER">
                    <span>I'M FRONTEND DEVELOPER</span>
                    <span>I'M FRONTEND DEVELOPER</span>
                    <span>I'M FRONTEND DEVELOPER</span>
                    <span>I'M FRONTEND DEVELOPER</span>
                </div>
            </div>

            <div class="visual__emoji">
                <div class="visual__emojiBg">
                    <span class="bg01"><img src="./assets/img/visual__emojiBg01.svg" alt=""></span>
                    <span class="bg02"><img src="./assets/img/visual__emojiBg02.svg" alt=""></span>
                    <span class="bg03"><img src="./assets/img/visual__emojiBg03.svg" alt=""></span>
                    <span class="bg04"><img src="./assets/img/visual__emojiBg04.svg" alt=""></span>
                    <span class="bg05"><img src="./assets/img/visual__emojiBg05.svg" alt=""></span>
                    <span class="bg06"><img src="./assets/img/visual__emojiBg06.svg" alt=""></span>
                </div>

                <div class="visual__emojiCircle">
                    <span class="circle01"><img src="./assets/img/visual__emojiCircle01.svg" alt=""></span>
                    <span class="circle02"><img src="./assets/img/visual__emojiCircle02.svg" alt=""></span>
                    <span class="circle03"><img src="./assets/img/visual__emojiCircle03.svg" alt=""></span>
                    <span class="circle04"><img src="./assets/img/visual__emojiCircle04.svg" alt=""></span>
                    <span class="circle05"><img src="./assets/img/visual__emojiCircle05.svg" alt=""></span>
                    <span class="circle06"><img src="./assets/img/visual__emojiCircle06.svg" alt=""></span>
                </div>

                <div class="visual__emojiItem">
                    <span class="item01"><img srcset="./assets/img/visual__emojiItem01.svg 2x" src="./assets/img/visual__emojiItem01.svg" alt=""></span>
                    <span class="item02"><img src="./assets/img/visual__emojiItem02.svg" alt=""></span>
                    <span class="item03"><img src="./assets/img/visual__emojiItem03.svg" alt=""></span>
                    <span class="item04"><img src="./assets/img/visual__emojiItem04.svg" alt=""></span>
                    <span class="item05"><img src="./assets/img/visual__emojiItem05.svg" alt=""></span>
                    <span class="item06"><img src="./assets/img/visual__emojiItem06.svg" alt=""></span>
                    <span class="item07"><img src="./assets/img/visual__emojiItem07.svg" alt=""></span>
                    <span class="item08"><img src="./assets/img/visual__emojiItem08.svg" alt=""></span>
                    <span class="item09"><img src="./assets/img/visual__emojiItem09.svg" alt=""></span>
                </div>
            </div>
        </section>
        <!-- //section1 -->
        <script>
            const showDemo = () => {
                document.body.style.overflow = 'auto';
                document.scrollingElement.scrollTo(0, 0);
                //gsap.to(document.querySelector('.loader'), { autoAlpha: 0 });
                
                gsap.utils.toArray('.demo').forEach((section, index) => {
                    const w = section.querySelector('.wrapper');
                    const [x, xEnd] = (index % 2) ? ['100%', (w.scrollWidth - section.offsetWidth) * -1] : [w.scrollWidth * -1, 0];
                    gsap.fromTo(w, {  x  }, {
                    x: xEnd,
                    scrollTrigger: { 
                        trigger: section, 
                        scrub: 0.5 
                    }
                    });
                });
            }
            showDemo();
        </script>

        <section id="section2" data-bgcolor="#e3857a" data-textcolor="#f1dba7"></section>
        <!-- //section2 -->

        <section id="section3" class="horizontal-scroll" data-textcolor="#bcb8ad" data-bgcolor="#815946">
            <div class="pin-wrap">
                <div>1</div>
                <div>2</div>
                <div>3</div>
                <div>4</div>
            </div>
        </section>
        <!-- //section3 -->

        <section id="section4" data-bgcolor="#e3857a" data-textcolor="#f1dba7"></section>
        <!-- //section4 -->

        <section id="section5" data-bgcolor="#e3857a" data-textcolor="#f1dba7"></section>
        <!-- //section5 -->

        <section id="section6" data-textcolor="#bcb8ad" data-bgcolor="#032f35"></section>
        <!-- //section6 -->
    </main>


    <script>
        window.addEventListener("load", function () {
            gsap.registerPlugin(ScrollTrigger);

            const pageContainer = document.querySelector("#contents");
            pageContainer.setAttribute("data-scroll-container", "");

            const scroller = new LocomotiveScroll({
                el: pageContainer,
                smooth: true,
                getDirection: true,
            });

            scroller.on("scroll", function (t) {
                document.documentElement.setAttribute("data-direction", t.direction);
            });

            scroller.on("scroll", ScrollTrigger.update);

            ScrollTrigger.scrollerProxy(pageContainer, {
                scrollTop(value) {
                    return arguments.length
                    ? scroller.scrollTo(value, 0, 0)
                    : scroller.scroll.instance.scroll.y;
                },
                getBoundingClientRect() {
                    return {
                        left: 0,
                        top: 0,
                        width: window.innerWidth,
                        height: window.innerHeight,
                    };
                },
                pinType: pageContainer.style.transform ? "transform" : "fixed",
            });

        // Pinning and horizontal scrolling
        let horizontalSections = document.querySelectorAll(".horizontal-scroll");

        horizontalSections.forEach((horizontalSection) => {
            let pinWrap = horizontalSection.querySelector(".pin-wrap");
            let pinWrapWidth = pinWrap.offsetWidth;
            let horizontalScrollLength = pinWrapWidth - window.innerWidth;

            gsap.to(pinWrap, {
                scrollTrigger: {
                    scroller: "[data-scroll-container]",
                    scrub: true,
                    trigger: horizontalSection,
                    pin: true,
                    start: "top top",
                    markers: true,
                    end: () => `+=${pinWrapWidth}`,
                    invalidateOnRefresh: true,
                },
                x: -horizontalScrollLength,
                ease: "none",
            });
        });

        /* COLOR CHANGER */
        const scrollColorElems = document.querySelectorAll("[data-bgcolor]");

        scrollColorElems.forEach((colorSection, i) => {
            const prevBg = i === 0 ? "" : scrollColorElems[i - 1].dataset.bgcolor;
            const prevText = i === 0 ? "" : scrollColorElems[i - 1].dataset.textcolor;

            ScrollTrigger.create({
                trigger: colorSection,
                scroller: "[data-scroll-container]",
                start: "top 50%",
                onEnter: () =>
                gsap.to("body", {
                    backgroundColor: colorSection.dataset.bgcolor,
                    color: colorSection.dataset.textcolor,
                    overwrite: "auto",
                }),
                onLeaveBack: () =>
                gsap.to("body", {
                    backgroundColor: prevBg,
                    color: prevText,
                    overwrite: "auto",
                }),
            });
        });

        ScrollTrigger.addEventListener("refresh", () => scroller.update());
        ScrollTrigger.refresh();
    });
    </script>
  </body>
</html>
